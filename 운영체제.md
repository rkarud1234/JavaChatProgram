# 멀티 스레드 채팅 서버 구현

## 1. 프로세스와 스레드

### 1.1. 프로세스
프로세스란 보조기억장치에 있는 프로그램 중 사용자 요청에 의해 메모리에 올라와 실행중인 프로그램을 말한다.      
프로세스의 실행은 CPU에서 담당하는데, 만약 CPU가 하나밖에 없다면 여러 개의 프로세스를 동시에 실행할 수 없을 것이다.
하지만 동시에 실행되는 것처럼 보일 수는 있다.
바로 OS의 **시분할(Time Share)** 이다.

<div align="center">
  <img src="https://user-images.githubusercontent.com/84266499/154707905-afef7cbb-6d0e-4fac-b24f-c7e5d94fcaac.png" width="60%" height="60%"/>
</div>

위 그림과 같이 하나의 CPU가 여러 개의 프로세스들을 눈치채지 못할 정도로 빠르게 순회하며 조금씩 실행한다. 하나의 CPU를 시분할하여 소모하는 것이다.    
이러한 방식을 **멀티태스크** 혹은 **멀티프로세스**라고 한다.

### 1.2. 멀티태스킹 동작 방식
멀티태스킹을 하기 위해서는 프로세스들을 순회하면서 프로세스를 잠깐 실행시키고 멈추는 작업을 반복적으로 진행한다. 즉, 원활한 멀티태스킹이 이루어지기 위해서는 각각의 프로세스마다 자신의 마지막 작업을 어디까지 진행했었는지 저장해놓을 **문맥 객체(Context)**를 가지고 있어야 한다.     
이렇게 프로세스들이 실행되면서 Context를 옮겨가며 정보를 저장하는 행위를 **Context Switching**이라고 한다.     

단일 CPU로 여러 개의 프로세스를 작동할 수 있는 것은 이점이지만, 멀티태스킹 동작 방식에는 문제점이 존재한다.      
실행해야 할 프로세스가 많아짐에 따라서 시분할 대상이 늘어나고, 컨텍스트 스위칭에 대한 부담이 늘어나면서 업무처리시간 외에 컨텍스트 스위칭에 소요되는 시간이 늘어나서 상대적으로 업무를 처리할 시간이 줄어든다.     
또한 프로세스 간에 항상 평등한 자원을 할당받지 못하는 경우도 생겨 **형평성 문제 및 성능의 저하가 발생**하게 되는데, 이에 대한 대안이 바로 **스레드**이다.      

### 1.3. 멀티스레드 동작 방식
![image](https://user-images.githubusercontent.com/84266499/174228426-bdb7da9b-4b65-4c30-8867-6bbb4e5829ef.png)        
1. 스레드는 stack영역을 제외한 프로세스의 heap, static, code 영역을 공유한다. > 스레드간의 데이터 공유가 쉬워짐 + 컨텍스트 스위칭 시 데이터 영역
2. 형평성 문제 해결 > 자원을 보다 효율적으로 관리

